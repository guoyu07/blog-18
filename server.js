module.exports=function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t.w={},t(t.s=28)}([function(e,n){e.exports=require("graphql-tag")},function(e,n){e.exports=require("axios")},function(e,n){e.exports=require("koa-session")},function(e,n){e.exports=require("koa-compose")},function(e,n){e.exports=require("koa")},function(e,n){e.exports=require("debug")},function(e,n){e.exports=require("date-fns/locale")},function(e,n){e.exports=require("date-fns")},function(e,n){e.exports=require("path")},function(e,n){e.exports=require("koa-static-cache")},function(e,n){e.exports=require("accept-language")},function(e,n){e.exports=require("fs")},function(e,n){e.exports=require("invert-color")},function(e,n){e.exports=require("qs")},function(e,n){e.exports=require("google-translate-api")},function(e,n){e.exports=require("crypto")},function(e,n){e.exports=require("uuid")},function(e,n){e.exports=require("node-fetch")},function(e,n){e.exports=require("koa-router")},function(e,n){e.exports=require("koa-bodyparser")},function(e,n){e.exports=require("apollo-link-http")},function(e,n){e.exports=require("apollo-client")},function(e,n){e.exports=require("apollo-cache-inmemory")},function(e,n){e.exports=require("vue-server-renderer")},function(e,n){e.exports=require("lru-cache")},function(e,n){e.exports=require("koa-logger")},function(e,n){e.exports=require("koa-compress")},function(e,n){e.exports=require("koa-better-http-proxy")},function(e,n,t){"use strict";t.r(n);var r,o=t(11),a=t.n(o),i=t(10),u=t.n(i),s=t(5),c=t.n(s),l=t(4),p=t.n(l),f=t(27),h=t.n(f),d=t(3),v=t.n(d),b=t(26),g=t.n(b),y=t(25),x=t.n(y),w=t(2),m=t.n(w),E=t(9),O=t.n(E),q=t(24),T=t.n(q),_=t(23),k=t(8),S=t.n(k),A=+process.env.PORT||7e3,I=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return S.a.resolve.apply(S.a,[process.cwd()].concat(e))},N=require,P=t(22),R=t(21),j=t.n(R),L=t(20),C=t(1),G=t.n(C),H=t(0),U=t.n(H),B=t(19),D=t.n(B),M=t(18),$=t.n(M),z=t(17),Y=t.n(z),K=t(16),F=t.n(K),Z=t(15),W=t.n(Z),X=t(14),J=t.n(X),Q=t(13),V=t.n(Q),ee=process.env.GITHUB_REPOSITORY_NAME,ne=process.env.GITHUB_REPOSITORY_OWNER;(process.env.GITHUB_EXCLUDED_LABELS||"").split(","),(process.env.GITHUB_EXCLUDED_REPOSITORY_OWNERS||"").split(",");!function(e){e.user="user",e.organization="organization"}(r||(r={}));process.env.GITHUB_REPOSITORY_OWNER_TYPE,r.user;var te,re={name:ee,owner:ne};!function(e){e.EN="en",e.ZH="zh"}(te||(te={}));var oe,ae,ie,ue=te.EN,se=te.ZH,ce=((oe={})[ue]=se,oe[se]=ue,oe),le=(te.EN,[te.EN,te.ZH]),pe=function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e},fe=(Object.assign,U()(ae||(ae=pe(["\n    query($name: String!, $owner: String!) {\n      repository(name: $name, owner: $owner) {\n        labels(first: 100) {\n          nodes {\n            color\n            id\n            name\n          }\n        }\n      }\n    }\n  "],["\n    query($name: String!, $owner: String!) {\n      repository(name: $name, owner: $owner) {\n        labels(first: 100) {\n          nodes {\n            color\n            id\n            name\n          }\n        }\n      }\n    }\n  "]))),t(12)),he=(t.n(fe).a,t(7),t(6)),de=((ie={})[te.EN]=he.enUS,ie[te.ZH]=he.zhCN,Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}),ve=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function u(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(i,u)}s((r=r.apply(e,n||[])).next())})},be=function(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},ge=process.env,ye=ge.GOOGLE_TRANSLATE_ENABLED,xe=ge.TENCENT_TRANSLATE_API_SECRET_ID,we=ge.TENCENT_TRANSLATE_API_SECRET_KEY,me={Action:"TextTranslate",Region:"ap-shanghai",SecretId:xe,SignatureMethod:"HmacSHA256"},Ee=function(e,n){return e>n?1:e<n?-1:0},Oe={zh:"zh-cn",en:"en"},qe=function(e,n){return ve(void 0,void 0,void 0,function(){var n,t,r,o,a,i,u,s;return be(this,function(c){switch(c.label){case 0:return n=e.query,t=n.source,(r=n.sourceText)?ye?[4,J()(r,{from:Oe[t],to:ce[t]})]:[3,2]:[2];case 1:return o=c.sent(),e.body=Object.assign(o,{text:o.text.replace(/<\/ ([^<>]+)>/g,"</$1>")}),[2];case 2:return l={source:t||e.cookies.get("LOCALE_COOKIE"),sourceText:r},a=de({},me,{Timestamp:Math.ceil(Date.now()/1e3),Nonce:Math.ceil(Math.random()*Number.MAX_SAFE_INTEGER)},l,{target:ce[l.source]}),i=W.a.createHmac("sha256",we).update("GETtmt.api.qcloud.com/v2/index.php?"+V.a.stringify(a,{encode:!1,sort:Ee})).digest("base64"),[4,G.a.get("https://tmt.api.qcloud.com/v2/index.php",{params:Object.assign(a,{Signature:i})})];case 3:return u=c.sent().data,s=u.targetText,e.body=de({},u,{targetText:s&&s.replace(/\<([^<>]+)\>/g,function(e,n){var t=(n=n.toLowerCase().replace(/ /g,"").replace(/\/+/g,"/")).indexOf("/");return-1!==t&&(n=n.substr(t)),"<"+n+">"})}),[2]}var l})})},Te=function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e},_e=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function u(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(i,u)}s((r=r.apply(e,n||[])).next())})},ke=function(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};global.fetch=Y.a;var Se=process.env,Ae=Se.APP_KEYS,Ie=Se.GITHUB_CLIENT_ID,Ne=Se.GITHUB_CLIENT_SECRET,Pe=c()("1stg:server:router"),Re=new $.a({prefix:"/api"});Re.get("/user",function(e,n){var t,r=e.session.user;r||(t=F()(),e.session.uuid=t),e.body=r||{uuid:t}}).get("/oauth",function(e,n){return _e(void 0,void 0,void 0,function(){var n,t,r,o,a,i,u;return ke(this,function(s){switch(s.label){case 0:return n=e.query,t=n.code,r=n.path,(o=n.state)&&o===e.session.uuid?[4,G.a.post("https://github.com/login/oauth/access_token",{client_id:Ie,client_secret:Ne,code:t,state:o},{headers:{Accept:"application/json"}})]:[2,e.throw("invalid oauth redirect")];case 1:return(a=s.sent().data).error?[2,e.throw(a)]:(i=a.access_token,e.session.token=i,[4,new j.a({link:Object(L.createHttpLink)({uri:"https://api.github.com/graphql",headers:{Authorization:"bearer "+i}}),cache:new P.InMemoryCache}).query({query:U()(je||(je=Te(["\n        query {\n          viewer {\n            avatarUrl\n            id\n            login\n            name\n            url\n            websiteUrl\n          }\n        }\n      "],["\n        query {\n          viewer {\n            avatarUrl\n            id\n            login\n            name\n            url\n            websiteUrl\n          }\n        }\n      "])))})]);case 2:return u=s.sent().data,e.session.user=u.viewer,e.redirect(""+r.replace(/ /g,"%2B")),[2]}})})}).get("/translate",qe);var je,Le=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},Ce=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function u(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(i,u)}s((r=r.apply(e,n||[])).next())})},Ge=function(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};u.a.languages(le);var He,Ue=process.env,Be=Ue.APP_KEYS,De=Ue.GITHUB_TOKEN,Me=c()("1stg:server"),$e=new p.a;$e.keys=Be.split(",");var ze=a.a.readFileSync(I("dist/template.html"),"utf-8"),Ye=[x()(),function(e,n){return Ce(void 0,void 0,void 0,function(){var t,r,o,a,i,s;return Ge(this,function(c){switch(c.label){case 0:return t=e.url,"GET"!==e.method||t.lastIndexOf(".")>t.lastIndexOf("/")||!["*/*","text/html"].find(function(n){return e.get("Accept").includes(n)})||/^\/(api|graphql)($|\/)/.test(e.url)?[2,n()]:[4,void 0];case 1:return c.sent(),r=Date.now(),o=e.cookies.get("LOCALE_COOKIE"),a=o||u.a.get(e.get("Accept-Language")),o||e.cookies.set("LOCALE_COOKIE",a,{httpOnly:!1,path:"/",expires:new Date("Fri, 31 Dec 9999 23:59:59 GMT")}),i={ctx:e,locale:a,title:"1stG Blog"},e.respond=!1,e.status=200,e.set({"Content-Type":"text/html"}),s=e.res,He.renderToStream(i).on("error",function(n){switch(e.status=n.status||500){case 302:return e.set({Location:n.url}),s.end();case 401:return e.redirect("/login?next="+t),s.end();case 404:return s.end("404 | Page Not Found");default:s.end("500 | Internal Server Error"),Me("error during render : "+t),console.error(n.stack)}}).on("end",function(){Me("whole request: "+(Date.now()-r)+"ms")}).pipe(s),[2]}})})}],Ke=O()("public",{maxAge:31536e6}),Fe=m()({},$e);a.a,Ze=N(I("dist/vue-ssr-server-bundle.json")),We={clientManifest:N(I("dist/vue-ssr-client-manifest.json"))},He=Object(_.createBundleRenderer)(Ze,Le({},We,{template:ze,inject:!1,cache:T()({max:1e3,maxAge:9e5}),basedir:I("dist/static"),runInNewContext:!1}));var Ze,We,Xe={};Ye.splice.apply(Ye,[1,0,g()(),Ke,O()("dist/static",{maxAge:31536e6},Xe),Fe].concat(function(e){var n=!!e,t=[D()(),Re.routes(),Re.allowedMethods()];if(e||((e=new p.a).keys=e.keys=Ae.split(","),t.unshift(m()({},e))),n)return t;e.use(v()(t)),e.listen(A+1,"localhost",function(){Pe("Router server is now running at %s:%s","localhost",A+1)})}($e))),Xe["/service-worker.js"].maxAge=0,Ye.push(h()("api.github.com/graphql",{filter:function(e){return"/graphql"===e.url},https:!0,proxyReqOptDecorator:function(e,n){return e.headers.Authorization="bearer "+(n.session.token||De),e}})),$e.use(v()(Ye)),$e.listen(A,"localhost",function(){Me("Server is now running at %s:%s","localhost",A)})}]);